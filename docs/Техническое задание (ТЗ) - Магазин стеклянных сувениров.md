Техническое задание на создание автоматизированной системы  
«Магазин стеклянных сувениров» (REST API)

1) Общие сведения

- Полное наименование программы: Серверное приложение REST API «Магазин стеклянных сувениров».
- Условное обозначение программы: ПКГХ 09.02.07 ИР-__-__ .358-22.П2
- Наименование организации‑разработчика: СПб ГБПОУ «Политехнический колледж городского хозяйства».
- Основание для разработки:
  - Задание на курсовое проектирование (см. файл «Задание на КП.pdf», утверждено преподавателем согласно учебному плану).
  - Методические указания к курсовому проекту (см. файл «Методические указания на курсовой проект.pdf»).
  - Пример оформления REST API (см. файл «Пример описания REST API.pdf»).
- Плановые сроки выполнения: начало — согласно календарному плану курсового проектирования; окончание — в срок, установленный графиком защиты курсового проекта текущего семестра.
- Исполнитель: Левитин Александр Евгеньевич, № студенческого билета 358‑22.

2) Цели и назначение создания автоматизированной системы

Цель: разработать серверное приложение с REST API для автоматизации процессов интернет‑магазина по продаже стеклянных сувениров: каталогизация товаров, категорияция, корзина, оформление заказов, управление медиафайлами, учет пользователей и ролей, администрирование.

Назначение: предоставление API для трех категорий пользователей:
- Незарегистрированные пользователи:
  - Просмотр каталога товаров и категорий.
  - Поиск/фильтрация товаров.
  - Просмотр карточек товара, отзывов (при наличии).
  - Регистрация и аутентификация.
- Зарегистрированные пользователи:
  - Авторизация, управление профилем.
  - Загрузка/обновление аватара (с валидацией формата и размера).
  - Управление корзиной: добавление/удаление/изменение количества.
  - Оформление заказа, просмотр истории заказов.
  - Создание постов/отзывов (если предусмотрено), с временной меткой и категорией.
- Администраторы:
  - Управление товарами и категориями (CRUD).
  - Управление заказами (подтверждение/статусы).
  - Управление пользователями и ролями.
  - Управление постами/категориями постов, модерация контента.
  - Управление и очистка связанных медиафайлов, аудит.

3) Характеристика объектов автоматизации

Автоматизируемые функции и процессы:
- Регистрация и аутентификация пользователей:
  - Регистрация с валидацией персональных данных.
  - Вход/выход, обновление и отзыв токенов доступа.
- Профиль пользователя:
  - Просмотр/редактирование персональных данных.
  - Загрузка/обновление/удаление аватара (файл с проверкой расширения и размера).
- Каталог и категории товаров:
  - Просмотр списка товаров, фильтрация по категориям/цене/наличию.
  - Просмотр карточки товара с описанием и медиа.
  - Администрирование: CRUD товаров и категорий.
- Корзина и оформление заказа:
  - Добавление товара в корзину, изменение количества, удаление.
  - Создание заказа на основе текущей корзины.
  - До подтверждения администратором заказ может быть отредактирован или отменен пользователем.
- Посты/новости/отзывы (контентный раздел):
  - Создание постов с обязательной временной меткой и категорией.
  - Прикрепление изображения/файла к посту (валидация).
  - Удаление поста должно удалять связанные медиафайлы.
- Управление медиафайлами:
  - Хранение изображений товаров, аватаров пользователей, вложений постов.
  - Автоматическое удаление файлов при удалении связанного ресурса.

4) Требования к автоматизированной системе

4.1 Общие требования к API
- Стиль взаимодействия: REST, формат данных — application/json.
- Кодировки: UTF‑8.
- Аутентификация: Bearer JWT в заголовке Authorization.
- Валидация: все входные данные валидируются; при ошибках возвращается статус 422 с описанием.
- Часовой пояс и временные метки: ISO 8601 (UTC) в полях created_at/updated_at.
- Локализация сообщений об ошибках — русский язык.

Примечание: Для авторизованных запросов заголовок должен содержать:
Authorization: Bearer {token}

4.2 Пример требований к запросам/ответам

Регистрация нового пользователя
- URL: {host}/api/register
- Method: POST
- Headers:
  - Content-Type: application/json
- Body:
{
  "first_name": "Иван",
  "last_name": "Петров",
  "phone": "+79001234568",
  "document_number": "1224567890",
  "password": "paSSword1"
}

Требования к полям:
- first_name — строка, кириллица/латиница, обязательное.
- last_name — строка, кириллица/латиница, обязательное.
- phone — строка, обязательное, уникальное, не менее 10 цифр, допускается ведущий «+».
- document_number — строка из 10 цифр, обязательное.
- password — строка не короче 6 символов, латинские буквы и цифры, обязательное.

Удачный ответ:
- Status: 204
- Body: null

Ошибка валидации:
- Status: 422
- Content-Type: application/json
- Body:
{
  "error": {
    "code": 422,
    "message": "Validation error",
    "errors": {
      "<field>": ["<сообщения об ошибке>"]
    }
  }
}

Аутентификация (получение токена)
- URL: {host}/api/login
- Method: POST
- Body:
{
  "phone": "+79001234568",
  "password": "paSSword1"
}
- Успех: 200, { "access_token": "<jwt>", "token_type": "Bearer", "expires_in": 3600 }
- Ошибка авторизации: 401, { "error": { "code": 401, "message": "Unauthorized" } }

Создание поста (контент) — с временной меткой и категорией
- URL: {host}/api/posts
- Method: POST
- Headers: Authorization: Bearer {token}, Content-Type: application/json
- Body:
{
  "title": "Новое поступление",
  "content": "Описание коллекции...",
  "category_id": 3
}
- Успех: 201, { "id": 101, "title": "...", "content": "...", "category_id": 3, "created_at": "2025-11-10T10:15:00Z" }
- Ошибки: 422 (валидация), 401 (нет токена), 403 (нет прав)

Загрузка файла (аватар профиля)
- URL: {host}/api/profile/avatar
- Method: POST
- Headers: Authorization: Bearer {token}, Content-Type: multipart/form-data
- Body (form-data):
  - file: binary, допустимые расширения: .jpg, .jpeg, .png, .webp; макс. размер — 5 MB
- Успех: 200, { "url": "https://cdn.example.com/u/358-22/avatar.webp" }
- Ошибки: 413 (слишком большой файл), 415 (неподдерживаемый тип), 422 (валидация имени/пустого файла)

Удаление поста и связанных файлов
- URL: {host}/api/posts/{id}
- Method: DELETE
- Headers: Authorization: Bearer {token}
- Успех: 204
- Система должна гарантировать каскадное удаление связанных медиафайлов.

Каталог товаров: примеры
- Список товаров: GET {host}/api/products?category_id=&q=&page=
- Товар по id: GET {host}/api/products/{id}
- Создать (админ): POST {host}/api/products
- Обновить (админ): PUT/PATCH {host}/api/products/{id}
- Удалить (админ): DELETE {host}/api/products/{id} — с удалением связанных изображений.

Требования заказчика (обязательные):
- Посты должны содержать временную метку (Timestamp) создания.
- Посты должны быть разбиты на категории.
- Профиль или другой ресурс должен содержать фотографию или файл (валидируются расширение и размер).
- При удалении ресурса должны удаляться связанные с ним файлы.

Нефункциональные требования (минимально необходимые):
- Безопасность: хеширование паролей (например, bcrypt), защита от SQL‑инъекций и XSS, проверка прав доступа по ролям.
- Надежность: атомарные операции при загрузке/удалении файлов и создании/удалении записей.
- Масштабируемость: пагинация списков, ограничение размеров загрузок.
- Логи и аудит: журналирование ключевых операций админ‑панели и ошибок.

5) Состав и содержание работ по созданию автоматизированной системы

Состав работ определяется п.2–5 задания на курсовое проектирование и включает, как минимум:
- Анализ требований и проектирование REST API (ресурсы, схемы, статусы).
- Проектирование БД (пользователи, роли, товары, категории, корзина, заказы, посты, медиафайлы, связи).
- Реализация серверного приложения и модулей хранения файлов.
- Реализация аутентификации/авторизации (JWT) и разграничения прав.
- Реализация валидации данных и обработки ошибок.
- Разработка тестовых сценариев Postman (успех/ошибки/авторизация).
- Подготовка эксплуатационной и пользовательской документации по API.

6) Порядок контроля и приемки автоматизированной системы

Контроль качества и приемка осуществляются с использованием Postman‑коллекции запросов к API. Для каждой автоматизируемой функции — не менее трех запросов, покрывающих:
- Успешные сценарии (2xx).
- Ошибки валидации (422).
- Ошибки авторизации/аутентификации (401/403).
- Ошибки доступа к несуществующим ресурсам (404).

Критерии приемки:
- Соответствие заявленным требованиям (функциональным и нефункциональным).
- Корректная обработка крайних случаев.
- Соответствие форматов запросов/ответов и кодов статусов.
- Удаление связанных файлов при удалении ресурса.

7) Требования к подготовке объекта автоматизации к вводу в действие

- Адрес размещения системы (пример): https://api.glass‑souvenirs.example.ru
- Исходный код доступен по адресу в GitHub (пример): https://github.com/<org>/<repo>
- Требования к серверу:
  - ОС семейства Linux; установлен Docker или совместимая среда.
  - Контейнер СУБД (например, PostgreSQL), контейнер приложения, объектное хранилище (S3‑совместимое) либо локальное хранилище с резервным копированием.
  - Конфигурация переменных окружения: DATABASE_URL, JWT_SECRET, STORAGE_ENDPOINT/BUCKET, MAX_UPLOAD_SIZE и т.д.
  - Реверс‑прокси (например, Nginx) с TLS‑сертификатами.
  - CI/CD скрипт для сборки и выката в staging/production.
- Работы на сервере:
  - Деплой контейнеров, инициализация БД (миграции), настройка бэкапов.
  - Настройка доменного имени и HTTPS.
  - Загрузка Postman‑коллекции и прогон тестов на стенде.

8) Требования к документированию

- Техническое задание (настоящий документ).
- Описание REST API (эндпоинты, схемы запрос/ответ, коды ошибок), формируемое в репозитории (например, OpenAPI/Swagger) и/или в Postman.
- Инструкция по развертыванию (README, переменные окружения, миграции).
- Тестовая Postman‑коллекция с окружениями (local/staging/prod).
- Эксплуатационные заметки: политика хранения и удаления файлов, ротация ключей, резервное копирование.

9) Источники разработки

- «Задание на КП.pdf»
- «Методические указания на курсовой проект.pdf»
- «Пример описания REST API.pdf»
- ГОСТ 34.602–2020 «Информационные технологии. Комплекс стандартов на автоматизированные системы. Техническое задание на создание автоматизированной системы».

Приложения (при необходимости)
- Таблицы валидации полей для основных сущностей (пользователь, товар, заказ, пост).
- Диаграмма сущностей БД (ER‑диаграмма).
- Коллекция Postman (JSON) и инструкции по ее использованию.



